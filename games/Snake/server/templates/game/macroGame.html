{% macro socketGame(name, prefix) %}
<script type="text/javascript">
    /* images in base64 */
    {% include "game/image-snake.js" %}

    const socket = io();
    /* at connection, register to get update about theses classes */
    socket.on('connect', function(){
        socket.emit('registerObject', ["{{GameName}}","{{ name }}"]);
    });
    let pos_tail = [[0,0],[0,0]];     /* last positions (to draw in white if needed) */
     /* when received update about a Game, just display it */
    socket.on('update', function(msg) {
        console.log(msg);
       let data = JSON.parse(msg);
       /* arena */
       if (data.hasOwnProperty('arena'))
           document.getElementById('{{prefix}}arena').innerHTML = data['arena'];
       if (data.hasOwnProperty('names')){
           document.getElementById('{{prefix}}name0').innerText = data['names'][0];
           document.getElementById('{{prefix}}name1').innerText = data['names'][1];
       }
        /* snakes */
        for(let pl=0;pl<2;pl++) {
            /* remove last snake */
            document.getElementById('t_' + pos_tail[pl][0] + '_' + pos_tail[pl][1]).style.backgroundImage='';
            /* draw the head, body and tail */
            let snake = data['pl'][pl];
            for (let j=0;j<snake.length; j++) {
                console.log(j);
                console.log(snake[j]);
                if (j == 0)
                    document.getElementById('t_' + snake[j][0] + '_' + snake[j][1]).style.backgroundImage = head[pl][snake[j][2]];
                else if (j == snake.length - 1)
                    document.getElementById('t_' + snake[j][0] + '_' + snake[j][1]).style.backgroundImage = tail[pl][snake[j][2]];
                else
                    document.getElementById('t_' + snake[j][0] + '_' + snake[j][1]).style.backgroundImage = body[pl][snake[j][2]][snake[j][3]];
            }
            /* keep the position of the tail*/
            pos_tail[pl] = snake[snake.length - 1];
            /* counter */
            document.getElementById('{{prefix}}counters'+pl.toString()).innerText = data['counters'][pl];
        }
    });



</script>
{% endmacro %}